# 22.1 소개하기

서버 개발시 DB를 사용하면 웹 서비스에서 사용되는 **데이터를 저장**하고, **효율적으로 조회하거나 수정이 가능**함   

**RDBMS** (관계형 데이터 베이스)의 한계
- 데이터 스키마가 고정적
    - 새로 등록해야하는 데이터 형식이 있느 경우, 기존 데이터를 모두 수정해야 함 
- 확장성
    - 저장하고 처리할 데이터 양이 틀어나면 해당 DB 서버 성능을 업그레이드하는 방식을 사용 

문서지향적 **NoSQL DB**
- 유동적인 스키마
- 쉬운 확장
    - 서버 데이터 양이 늘어나도 여러 컴퓨터로 분산하여 처리


데이터 구조가 자주 바뀌는 환경은 **MongoDB**가 유리    
까다로운 조건으로 데이터를 필터링해야 하거나, ACID 특성을 지켜야 한다면 **RDMBS**가 더 유리    

※ ACID 특성: 원자성, 일관성, 고립성, 지소성으로 DB 트랜잭션이 안전하게 처리되는 것을 보장


### 문서 (documents)
RDBMS의 레코드(record)와 비슷한 개념    
- 문서의 데이터 구조는 한 개 이상의 키-값 쌍으로 구성
- 새로운 문서를 만들면 `_id` 고유값 자동 생성
- 다른 스키마를 가지는 문서들이 한 컬렉션(여러 문서가 들어있는 곳)에서 공존 가능

### MongoDB 구조
서버 > 데이터베이스 > 컬렉션 > 문서


### 스키마 디자인
#### RDBMS 
각 포스트, 댓글마다 테이블을 만들어 필요에 따라 조인    
<img src="./Images/ch22/01.png" width="300px" >

#### NoSQL
모든 것을 문서 하나에 넣음

```sql
{
  _id: ObjectId,
  title: String,
  body: String,
  username: String,
  createDate: Date,
  comments: [
    {
      _id: ObjectId,
      text: String,
      createDate: Date,
    },
  ],
};
```

- 서브다큐먼트 (subdocument)
    - 문서 내부에 또 다른 문서가 위치함
    - 일반 문서를 다루는 것처럼 쿼리 가능
- 문서 하나에 최대 16MB 데이터 용량 (100자 댓글 데이터 기 68,000개)  


<br>

# 22.2 MongoDB 서버 준비
설치과정 생략



<br>

# 22.3 mongoose의 설치 및 적용

### `mongoose`
Node.js 환경에서 사용하는 **MongoDB 기반 ODM(Object Data Modelling) 라이브러리**     
DB 문서들을 자바스크립트 객체처럼 사용 가능   

### dotenv
**환경변수들을 파일에 넣고 사용**할 수 있게 하는 개발 도구   
mongoose를 사용해 MongoDB 서버 접속시, 서버에 주소나 계정 및 비밀번호가 필요한 경우 민감하거나 환경별로 달라질 수 있는 값을 코드 안에 직접 작성하지 않고 **환경변수로 설정**하는 것이 좋음    
프로젝트를 github에 올릴 때, `.gitignore`를 작성해 환경변수 파일을 제외해야 함

`yarn add mongoose dotenv`: 프로젝트 디렉터리에 mongoose와 dotenv 설치     





<br>

# 22.4 esm으로 ES 모듈 import/export 문법 사용 


<br>

# 22.5 데이터베이스의 스키마 모델


<br>

# 22.6 MongoDB Compass의 설치 및 사용


<br>

# 22.7 데이터 생성과 조회 


<br>

# 22.8 데이터 삭제와 수정


<br>

# 22.9 요청 검증 


<br>

# 22.10 페이지네이션 구현


<br>

# 22.11 정리
